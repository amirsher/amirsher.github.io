 <!DOCTYPE html>
<html>
<head>
    <title>Bluetooth Echo</title>
    <style>
        button {
            width: 20ch;
            font-size: 48px;
            margin: 20px;
            padding: 10px;
            box-sizing: border-box;
      }
      #main {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-top: 50px;
      }
    </style>
</head>
<body>
<div id="main">
  <button id="connectB" onclick="connectBT()" >connect</button>
  <button id="sendB" onclick="sendMessageT()" style="display:none;">door</button>
</div>

  </body>
<script>
  var bluetooth = null;
  // shared UUIDs between MicroPython and JS
  const UART_SERVICE_ID = '6E400001-B5A3-F393-E0A9-E50E24DCCA9E'.toLowerCase();
  const CHARACTERISTIC_TX = '6E400003-B5A3-F393-E0A9-E50E24DCCA9E'.toLowerCase();
  const CHARACTERISTIC_RX = '6E400002-B5A3-F393-E0A9-E50E24DCCA9E'.toLowerCase();


async function connectBT() {
navigator.bluetooth.requestDevice({ filters: [{ name: "mpy-uart" },] })
.then(device => device.gatt.connect())
.then(server => server.getPrimaryService(UART_SERVICE_ID))
.then(service => service.getCharacteristic(CHARACTERISTIC_RX))
.then(characteristic => {
  // Writing 1 is the signal to reset energy expended.
//  const resetEnergyExpended = Uint8Array.of(1);
    let encoder = new TextEncoder(); // Encode string to bytes
//    let data = encoder.encode(textToWrite);
    let data = encoder.encode('Toggle');
  return characteristic.writeValue(data);
})
.then(_ => {
  console.log('Energy expended has been reset.');
location.reload();
})
.catch(error => { console.error(error); });}


</script>
</html>
